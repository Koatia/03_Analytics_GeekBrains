### [Урок 6. Сравнение долей. Построение доверительного интервала](https://gb.ru/lessons/447658/homework)

#### Задание 1

**_Известно, что генеральная совокупность распределена нормально со средним квадратическим отклонением, равным 16. Найти доверительный интервал для оценки математического ожидания a с надежностью 0.95, если выборочная средняя M = 80, а объем выборки n = 256._**

При известной сигма ($\sigma = 16$) генеральной совокупности используем z-критерий для расчета доверительного интервала.

```
left = 80 - 1.96*16/256*0.5
right = 80 + 1.96*16/256*0.5
print(f'>>> Доверительный интервал: [{left}; {right}].')
```

Для нахождения доверительного интервала для оценки математического ожидания $\mu$ с надежностью 0.95, зная, что генеральная совокупность распределена нормально и стандартное отклонение известно ($\sigma = 16$), можно использовать Z-критерий. Формула для доверительного интервала выглядит следующим образом:

$\bar{X} \pm Z_{\alpha/2} \left( \frac{\sigma}{\sqrt{n}} \right)$

где:

- $\bar{X}$ — выборочная средняя,
- $Z_{\alpha/2}$ — критическое значение Z для заданного уровня надежности (например, для 95%),
- $\sigma$ — стандартное отклонение,
- $n$ — объем выборки.

Дано:

- Выборочная средняя ($\bar{X}$) = 80
- Стандартное отклонение ($\sigma$) = 16
- Объем выборки ($n$) = 256
- Уровень надежности = 0.95 (соответствующее $\alpha = 0.05$)

1. Найти критическое значение $Z_{\alpha/2}$:

Для уровня надежности 0.95 и $\alpha = 0.05$, критическое значение Z (из таблицы стандартного нормального распределения) для $\alpha/2 = 0.025$ составляет:

$Z_{\alpha/2} \approx 1.96$

2. Вычислить стандартную ошибку ($SE$):

$SE = \frac{\sigma}{\sqrt{n}} = \frac{16}{\sqrt{256}} = \frac{16}{16} = 1$

3. Вычислить доверительный интервал:

$80 \pm 1.96 \times 1$

$\text{Нижняя граница} = 80 - 1.96 \times 1 = 80 - 1.96 = 78.04$

$\text{Верхняя граница} = 80 + 1.96 \times 1 = 80 + 1.96 = 81.96$

Ответ

Доверительный интервал для оценки математического ожидания $\mu$ с надежностью 0.95 составляет $[78.04, 81.96]$.

#### Задание 2

**_В результате 10 независимых измерений некоторой величины X, выполненных с одинаковой точностью, получены опытные данные: 6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1 Предполагая, что результаты измерений подчинены нормальному закону распределения вероятностей, оценить истинное значение величины X при помощи доверительного интервала, покрывающего это значение с доверительной вероятностью 0,95._**

Если сигма неизвестна, находим ее по формуле для несмещенного стандартного отклонения

```
import math
import numpy as np
import scipy.stats as stats
array = [6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1]
n = len(array)
x = np.mean(array)
print(f'>>> Среднее арифметическое: {x}')
a = 0.05
sigma = np.std(array, ddof=1)
print(f'>>> Среднее квадратическое отклонение (несмещенное): {sigma}')
stats = stats.t.ppf( 1-a/2, n-1)
print(f'>>> Значение t-критерия для {1-a}% доверительного интервала: {stats}')
left = x-stats*sigma/np.sqrt(n)
right = x+stats*sigma/np.sqrt(n)
print(f'>>> Доверительный интервал для величины "X" составляет: [{left:.3f} ; {right:.3f}]')
```

Оценка истинного значения величины X с использованием доверительного интервала

Для оценки истинного значения величины $X$ с доверительной вероятностью 0.95, воспользуемся выборочными данными и построим доверительный интервал для среднего значения.

Дано:

$\{6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1\}$

- Вычисление выборочного среднего ($\bar{X}$):

$\bar{X} = \frac{1}{n} \sum_{i=1}^{n} X_i$

$\bar{X} = \frac{6.9 + 6.1 + 6.2 + 6.8 + 7.5 + 6.3 + 6.4 + 6.9 + 6.7 + 6.1}{10} = \frac{64.9}{10} = 6.49$

- Вычисление выборочного стандартного отклонения ($s$):

$s = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (X_i - \bar{X})^2}$

Вычислим $s$:

$s = \sqrt{\frac{1}{9} \left((6.9 - 6.49)^2 + (6.1 - 6.49)^2 + (6.2 - 6.49)^2 + (6.8 - 6.49)^2 + (7.5 - 6.49)^2 + (6.3 - 6.49)^2 + (6.4 - 6.49)^2 + (6.9 - 6.49)^2 + (6.7 - 6.49)^2 + (6.1 - 6.49)^2 \right)}$

$s = \sqrt{\frac{1}{9} (0.1681 + 0.1521 + 0.0841 + 0.0961 + 1.0201 + 0.0361 + 0.0081 + 0.1681 + 0.0441 + 0.1521)}$

$s = \sqrt{\frac{1}{9} (1.929)} = \sqrt{0.21433} \approx 0.463$

- Определение критического значения t для доверительного уровня 0.95 и 9 степеней свободы (из таблицы t-распределения):

$t_{0.025, 9} \approx 2.262$

- Вычисление доверительного интервала:

$\text{Доверительный интервал} = \bar{X} \pm t \left( \frac{s}{\sqrt{n}} \right)$

$\text{Доверительный интервал} = 6.49 \pm 2.262 \left( \frac{0.463}{\sqrt{10}} \right) = 6.49 \pm 2.262 \left( 0.146 \right) = 6.49 \pm 0.33$

$\text{Доверительный интервал} = [6.16, 6.82]$

Ответ:

Доверительный интервал для истинного значения величины $X$ с доверительной вероятностью 0.95 составляет $[6.16, 6.82]$.

#### Задание 3

**_Рост дочерей 175, 167, 154, 174, 178, 148, 160, 167, 169, 170 Рост матерей 178, 165, 165, 173, 168, 155, 160, 164, 178, 175 Используя эти данные построить 95% доверительный интервал для разности среднего роста родителей и детей._**

```
import math
import numpy as np
import scipy.stats as stats
mum = np.array([178, 165, 165, 173, 168, 155, 160, 164, 178, 175])
daut = np.array([175, 167, 154, 174, 178, 148, 160, 167, 169, 170])
m = len(mum)
d = len(daut)
print(m, d)
a = 0.975
means = np.mean(mum) - np.mean(daut)
error = np.sqrt(np.var(mum, ddof=1)/m + np.var(daut, ddof=1)/d)
t_crit = stats.t.ppf( a, m+n-2 )
left = means - t_crit * error
right = means + t_crit * error

print(f'>>> 95% доверительный интервал для разности среднего роста родителей и детей: [{left:.2f}, {right:.2f}]')
```

95% доверительный интервал для разности среднего роста родителей и детей

- Вычисление среднего роста дочерей ($\bar{X}_d$) и матерей ($\bar{X}_m$)\*\*:

$\bar{X}_d = \frac{1}{10} \sum_{i=1}^{10} \text{Рост дочерей}_i$

$\bar{X}_d = \frac{175 + 167 + 154 + 174 + 178 + 148 + 160 + 167 + 169 + 170}{10} = \frac{1662}{10} = 166.2$

$\bar{X}_m = \frac{1}{10} \sum_{i=1}^{10} \text{Рост матерей}_i$

$\bar{X}_m = \frac{178 + 165 + 165 + 173 + 168 + 155 + 160 + 164 + 178 + 175}{10} = \frac{1681}{10} = 168.1$

- Вычисление разности средних ($\bar{d} = \bar{X}_m - \bar{X}_d$):

$\bar{d} = 168.1 - 166.2 = 1.9$

- Вычисление стандартного отклонения разностей ($s_d$):

$d_i = \text{Рост матерей}_i - \text{Рост дочерей}_i$

$d = \{3, -2, 11, -1, -10, 7, 0, -3, 9, 5\}$

$\bar{d} = 1.9$

$s_d = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (d_i - \bar{d})^2}$

$s_d = \sqrt{\frac{1}{9} ((3 - 1.9)^2 + (-2 - 1.9)^2 + (11 - 1.9)^2 + (-1 - 1.9)^2 + (-10 - 1.9)^2 + (7 - 1.9)^2 + (0 - 1.9)^2 + (-3 - 1.9)^2 + (9 - 1.9)^2 + (5 - 1.9)^2)}$

$s_d = \sqrt{\frac{1}{9} (1.21 + 15.21 + 82.81 + 8.41 + 139.21 + 26.01 + 3.61 + 24.01 + 50.41 + 9.61)}$

$s_d = \sqrt{\frac{1}{9} (360.5)} = \sqrt{40.06} \approx 6.33$

- Определение критического значения t для доверительного уровня 0.95 и 9 степеней свободы (из таблицы t-распределения):

$t_{0.025, 9} \approx 2.262$

- Вычисление доверительного интервала:

$\text{Доверительный интервал} = \bar{d} \pm t \left( \frac{s_d}{\sqrt{n}} \right)$

$\text{Доверительный интервал} = 1.9 \pm 2.262 \left( \frac{6.33}{\sqrt{10}} \right) = 1.9 \pm 2.262 \left( 2.00 \right) = 1.9 \pm 4.52$

$\text{Доверительный интервал} = [-2.62, 6.42]$

Ответ:

Доверительный интервал для разности среднего роста дочерей и матерей с доверительной вероятностью 0.95 составляет $[-2.62, 6.42]$.
