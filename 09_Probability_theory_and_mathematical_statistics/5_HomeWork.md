### [Урок 5. Тестирование гипотез](https://gb.ru/lessons/447657/homework)

#### Задание 1

Когда используется критерий Стьюдента, а когда Z –критерий?

> `t-критерий:` Используется, когда дисперсия генеральной совокупности неизвестна и оценивается по выборке.
>
> `Z-критерий:` Используется, когда известна дисперсия генеральной совокупности.

#### Задание 2 _(решать вручную)_

Проведите тест гипотезы. Утверждается, что шарики для подшипников, изготовленные автоматическим станком, имеют средний диаметр 17 мм. Используя односторонний критерий с α=0,05, проверить эту гипотезу, если в выборке из n=100 шариков средний диаметр оказался равным 17.5 мм, а дисперсия известна и равна 4 кв. мм.

> $z_p=\frac{X-\mu}{se}; \quad \text{Стандартная ошибка среднего } se=\frac{\sigma}{\sqrt{n}}$
>
> $\alpha=0.05; \quad se=\frac{\sqrt{4}}{\sqrt{100}}=0.2; \quad z_p=\frac{17.5-17}{0.2}=2.5$
>
> Степень свободы $df=2×(n-1); \quad df = 2×(100-1) = 198$
>
> Критическое значение (односторонний тест) для уровня статистической значимости $\alpha=0.05 \quad z_{кр}=1.645$

**Так как `z-расчетное` $z_p=2.5$ больше, чем `z-критическое` $z_{кр}=1.645$, то мы отвергаем нулевую гипотезу. Средний диаметр шариков, изготовленных автоматическим станком, больше 17 мм.**

#### Задание 3 _(решать вручную)_

Проведите тест гипотезы. Продавец утверждает, что средний вес пачки печенья составляет 200 г. Из партии извлечена выборка из 10 пачек. Вес каждой пачки составляет: 202, 203, 199, 197, 195, 201, 200, 204, 194, 190. Известно, что их веса распределены нормально. Верно ли утверждение продавца, если учитывать, что доверительная вероятность равна 99%? (Провести двусторонний тест.)

> Нулевая гипотеза ($H_0$​): Средний вес пачки печенья равен 200 г ($μ=200$).
> Альтернативная гипотеза ($H_1$​): Средний вес пачки печенья не равен 200 г ($μ≠200$). Уровнь значимости 1% (доверительная вероятность 99%).

> Расчет выборочного среднего и выборочного стандартного отклонения

- Выборочное среднее ($\bar{x}$):

> $\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i; \quad \bar{x} = 198.5$

- Выборочное стандартное отклонение ($s$):

> $s = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2}; \quad s≈4.4535$

> $t_p = \frac{\bar{x} - \mu}{s / \sqrt{n}}; \quad t_p ≈-1.0651$

- Определение критического значения

> Для доверительной вероятности 99% и двустороннего теста используем таблицу t-распределения с 9 степенями свободы (в данном случае $(10 - 1) = 9$ степеней свободы)
>
> $t_{kp}=3.250$

> Заключение:
> Поскольку значение t-статистики (-1.0651) меньше критического значения (3.25), мы не отвергаем нулевую гипотезу. Следовательно, утверждение продавца о том, что средний вес пачки печенья составляет 200 г, верно на уровне значимости 1%.

#### Задание 4 _(решать с помощью функции)_

Есть ли статистически значимые различия в росте дочерей?
Рост матерей 172, 177, 158, 178, 175, 164, 160, 169, 165
Рост взрослых дочерей: 173, 175, 162, 174, 175, 168, 155, 170, 160

> Нулевая гипотеза ($H_0$​): Средний рост матерей равен среднему росту дочерей. ($μ=9$).
>
> Альтернативная гипотеза ($H_1$​): Средний рост матерей не равен среднему росту дочерей.

Для проверки наличия статистически значимых различий в росте матерей и их взрослых дочерей можно использовать парный t-тест (paired t-test). Этот тест используется для сравнения средних значений двух связанных выборок (например, рост матерей и их дочерей).

- Расчет разностей между парами значений:

> $d_i = \text{матери}_i - \text{дочери}_i$

- Вычисление среднего значения разностей $(\bar{d})$:

> $\bar{d} = \frac{1}{n} \sum_{i=1}^{n} d_i$

- Вычисление стандартного отклонения разностей (s):

> $s = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} (d_i - \bar{d})^2}$

- Вычисление t-статистики:

> $t = \frac{\bar{d}}{s / \sqrt{n}}$

- Определение критического значения:

> Для двустороннего теста с уровнем значимости ($\alpha = 0.05$) и ($n-1$) степенями свободы (в данном случае (9 - 1 = 8) степеней свободы), используем таблицу t-распределения.

- Сравнение t-статистики с критическим значением и принятие решения.

> Использование Python:

```python
import numpy as np
from scipy import stats

# Данные
mothers = np.array([172, 177, 158, 178, 175, 164, 160, 169, 165])
daughters = np.array([173, 175, 162, 174, 175, 168, 155, 170, 160])

# Вычисление разностей
differences = mothers - daughters

# Среднее значение разностей
mean_diff = np.mean(differences)

# Стандартное отклонение разностей
std_diff = np.std(differences, ddof=1)

# Количество наблюдений
n = len(differences)

# t-статистика
t_stat = mean_diff / (std_diff / np.sqrt(n))

# Критическое значение для двустороннего теста с уровнем значимости 0.05 и 8 степенями свободы
alpha = 0.05
t_critical = stats.t.ppf(1 - alpha/2, df=n-1)

# p-значение
p_value = 2 * (1 - stats.t.cdf(abs(t_stat), df=n-1))

t_stat, t_critical, p_value
```

- Результаты

```python
# Пример вывода
(0.565685424949238 2.306004135204166 0.5871188240948397)
```

- Интерпретация

1. **t-статистика:** ( 0.566 )
2. **Критическое значение:** ( 2.306 )
3. **p-значение:** ( 0.587 )

> Поскольку значение t-статистики (0.566) меньше критического значения (2.306) и p-значение (0.587) больше уровня значимости (0.05), мы не отвергаем нулевую гипотезу.
>
> Это означает, что нет статистически значимых различий в росте матерей и их взрослых дочерей на уровне значимости 0.05.
